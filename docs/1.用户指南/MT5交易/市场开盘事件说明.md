# 市场开盘事件说明

## 市场开盘事件概述

市场开盘事件是指在交易所开市时刻添加的特殊财经事件标记，作为交易日中的重要时间点参考。在本系统中，市场开盘事件主要用于补充晚间时段（北京时间19:00-24:00）没有重要财经事件的交易日，确保交易策略始终能够获得足够的市场博弈参考点。

## 市场开盘事件的意义

1. **市场流动性节点**：主要市场开盘时刻通常伴随着流动性的显著提升
2. **价格剧烈波动时机**：开盘时段经常出现价格的快速变动
3. **多空博弈集中点**：开盘时段是市场多空双方力量集中体现的时间点
4. **交易策略参考点**：为没有重要财经事件的交易日提供策略执行参考

## 自动添加规则

系统会在以下条件下自动添加市场开盘事件：

1. **晚间时段定义**：北京时间19:00-24:00（可在配置文件中调整）
2. **触发条件**：某交易日在晚间时段内没有任何筛选后的重要财经事件
3. **添加时机**：在筛选财经事件数据过程的最后阶段自动添加

## 市场开盘事件类型

系统会添加以下市场开盘事件：

| 市场 | 开盘时间（北京时间） | 事件描述 |
|------|-------------------|---------|
| 美股市场 | 21:30 | 美股市场开盘 |
| 纳斯达克 | 21:30 | 纳斯达克市场开盘 |
| 道琼斯 | 21:30 | 道琼斯工业平均指数市场开盘 |
| 标普500 | 21:30 | 标准普尔500指数市场开盘 |

## 数据格式

市场开盘事件在CSV文件中的格式如下：

```
日期,时间,货币,事件,重要性,实际值,预测值,前值
2023-03-01,21:30,USD,美股市场开盘,4,,,
```

其中：
- **日期**：实际日期，格式为`YYYY-MM-DD`
- **时间**：开盘时间，格式为`HH:MM`
- **货币**：统一使用`USD`（美元）
- **事件**：市场开盘事件描述
- **重要性**：统一设置为`4`级重要性
- **实际值、预测值、前值**：留空（这些字段对开盘事件不适用）

## 市场开盘事件的使用

市场开盘事件可用于以下场景：

1. **交易策略触发**：作为策略的潜在进场或出场信号点
2. **波动性预测**：提前做好市场可能大幅波动的准备
3. **风险控制**：在开盘前调整仓位或风险敞口
4. **价格反转识别**：识别开盘时的价格反转或延续模式

## 在MT5中的应用

MT5平台可以识别和显示这些市场开盘事件，方法如下：

1. 确保筛选后的数据已导出为MT5兼容格式
2. 在MT5中导入财经日历数据
3. 在图表中激活"财经日历"指标
4. 市场开盘事件将在图表上以标记形式显示

## 数量统计参考

根据历史数据统计，系统添加的市场开盘事件数量如下：

| 年份 | 市场开盘事件数量 |
|------|----------------|
| 2021 | 268 |
| 2022 | 280 |
| 2023 | 274 |
| 2024 | 268 |

## 自定义配置

如需自定义市场开盘事件的行为，可在配置文件和源代码中进行以下调整：

### 1. 修改晚间时段定义

在`config/config.json`中：

```json
{
  "calendar_filter": {
    "evening_time": {
      "start": "19:00",
      "end": "24:00"
    }
  }
}
```

### 2. 修改添加条件

在`src/filters/calendar_filter.py`中：

```python
def _add_market_open_for_evening(self, events_df, date):
    """
    为晚间时段没有事件的日期添加市场开盘事件
    """
    # 自定义修改逻辑...
```

### 3. 自定义开盘事件

在`src/filters/calendar_filter.py`中：

```python
MARKET_OPEN_EVENTS = [
    {"time": "21:30", "currency": "USD", "event": "美股市场开盘", "importance": 4},
    # 可添加或修改其他开盘事件
]
``` 